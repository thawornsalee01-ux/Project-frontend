{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///D:/document-versioning-ui/app/compare/%5Bid%5D/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useParams } from \"next/navigation\";\r\nimport { useEffect, useMemo, useState, useRef } from \"react\";\r\nimport html2canvas from \"html2canvas\";\r\nimport jsPDF from \"jspdf\";\r\nimport {\r\n  ArrowPathIcon,\r\n  ExclamationTriangleIcon,\r\n  DocumentMagnifyingGlassIcon,\r\n  ClipboardIcon,\r\n  LightBulbIcon,\r\n  ChatBubbleLeftRightIcon,\r\n  SparklesIcon,\r\n  MagnifyingGlassIcon,\r\n  FunnelIcon,\r\n  InformationCircleIcon,\r\n  DocumentArrowDownIcon,\r\n  PrinterIcon,\r\n  AdjustmentsHorizontalIcon,\r\n  BoltIcon,\r\n  BeakerIcon,\r\n  ScaleIcon,\r\n} from \"@heroicons/react/24/outline\";\r\n\r\n/* ================= TYPES ================= */\r\n\r\ntype ChangeType = \"ADDED\" | \"REMOVED\" | \"MODIFIED\";\r\ntype RiskLevel = \"LOW\" | \"MEDIUM\" | \"HIGH\";\r\ntype AiMode = \"short\" | \"detailed\" | \"legal\" | \"risk\";\r\n\r\ntype ChangeItem = {\r\n  id: number;\r\n  change_type: ChangeType;\r\n  section_label: string | null;\r\n  old_text: string | null;\r\n  new_text: string | null;\r\n  risk_level?: RiskLevel | null;\r\n  ai_comment?: string | null;\r\n  ai_suggestion?: string | null;\r\n  risk_reason?: string | null;\r\n};\r\n\r\ntype ComparisonDetail = {\r\n  id: number;\r\n  document_name: string;\r\n  version_old_label: string;\r\n  version_new_label: string;\r\n  created_at: string;\r\n  overall_risk_level?: string | null;\r\n  summary_text?: string | null;\r\n  changes: ChangeItem[];\r\n};\r\n\r\ntype ChatState = {\r\n  open: boolean;\r\n  mode: AiMode;\r\n  question: string;\r\n  loading: boolean;\r\n  answer: string;\r\n  error: string | null;\r\n};\r\n\r\nconst API_BASE =\r\n  process.env.NEXT_PUBLIC_API_BASE?.trim() || \"http://127.0.0.1:8000\";\r\n\r\n/* ================= HELPERS ================= */\r\n\r\nfunction normalizeText(s?: string | null) {\r\n  return (s || \"\").toString().trim();\r\n}\r\n\r\nfunction contains(hay: string, needle: string) {\r\n  return hay.toLowerCase().includes(needle.toLowerCase());\r\n}\r\n\r\nfunction formatDateTime(iso: string) {\r\n  try {\r\n    return new Date(iso).toLocaleString(\"th-TH\", {\r\n      year: \"numeric\",\r\n      month: \"short\",\r\n      day: \"numeric\",\r\n      hour: \"2-digit\",\r\n      minute: \"2-digit\",\r\n    });\r\n  } catch {\r\n    return iso;\r\n  }\r\n}\r\n\r\nfunction formatDateForReport(iso: string) {\r\n  try {\r\n    return new Date(iso).toLocaleDateString(\"th-TH\", {\r\n      year: \"numeric\",\r\n      month: \"long\",\r\n      day: \"numeric\",\r\n    });\r\n  } catch {\r\n    return iso;\r\n  }\r\n}\r\n\r\nfunction riskBadge(risk?: string | null) {\r\n  const base = \"px-3 py-1 rounded-md font-bold\";\r\n  const level = (risk || \"LOW\").toUpperCase();\r\n\r\n  if (level === \"HIGH\")\r\n    return <span className={`${base} bg-gradient-to-r from-red-500 to-red-600 text-white text-sm shadow-sm`}>HIGH</span>;\r\n  if (level === \"MEDIUM\")\r\n    return <span className={`${base} bg-gradient-to-r from-amber-500 to-amber-600 text-white text-sm shadow-sm`}>MEDIUM</span>;\r\n  return <span className={`${base} bg-gradient-to-r from-emerald-500 to-emerald-600 text-white text-sm shadow-sm`}>LOW</span>;\r\n}\r\n\r\nfunction changeTypeBadge(type: ChangeType) {\r\n  const base = \"px-3 py-1 rounded-md font-bold\";\r\n  if (type === \"ADDED\")\r\n    return <span className={`${base} bg-gradient-to-r from-emerald-500 to-emerald-600 text-white text-sm shadow-sm`}>ADDED</span>;\r\n  if (type === \"REMOVED\")\r\n    return <span className={`${base} bg-gradient-to-r from-red-500 to-red-600 text-white text-sm shadow-sm`}>REMOVED</span>;\r\n  return <span className={`${base} bg-gradient-to-r from-amber-500 to-amber-600 text-white text-sm shadow-sm`}>MODIFIED</span>;\r\n}\r\n\r\nasync function copyToClipboard(text: string) {\r\n  try {\r\n    await navigator.clipboard.writeText(text);\r\n    return true;\r\n  } catch {\r\n    try {\r\n      const el = document.createElement(\"textarea\");\r\n      el.value = text;\r\n      document.body.appendChild(el);\r\n      el.select();\r\n      document.execCommand(\"copy\");\r\n      document.body.removeChild(el);\r\n      return true;\r\n    } catch {\r\n      return false;\r\n    }\r\n  }\r\n}\r\n\r\nfunction CopyButton({ text, label = \"คัดลอก\", size = \"md\", variant = \"default\" }: {\r\n  text: string;\r\n  label?: string;\r\n  size?: \"sm\" | \"md\";\r\n  variant?: \"default\" | \"primary\";\r\n}) {\r\n  const disabled = !text || text.trim().length === 0;\r\n  \r\n  const baseClasses = `\r\n    inline-flex items-center gap-1 ${size === \"sm\" ? \"px-3 py-1.5 text-sm\" : \"px-4 py-2 text-base\"}\r\n    rounded-lg font-medium transition-all duration-200\r\n    ${disabled ? \"opacity-50 cursor-not-allowed\" : \"hover:scale-[1.02] active:scale-[0.98]\"}\r\n  `;\r\n  \r\n  const variantClasses = variant === \"primary\" \r\n    ? \"bg-gradient-to-r from-blue-600 to-blue-700 text-white hover:from-blue-700 hover:to-blue-800 shadow-sm\"\r\n    : \"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50 hover:border-gray-400\";\r\n\r\n  return (\r\n    <button\r\n      type=\"button\"\r\n      disabled={disabled}\r\n      onClick={async () => await copyToClipboard(text)}\r\n      className={`${baseClasses} ${variantClasses}`}\r\n    >\r\n      <ClipboardIcon className=\"h-4 w-4\" />\r\n      {label}\r\n    </button>\r\n  );\r\n}\r\n\r\n/* ================= DIFF VIEW COMPONENT ================= */\r\n\r\nfunction DiffView({ oldText, newText }: { oldText: string; newText: string }) {\r\n  const oldWords = oldText.split(/(\\s+)/);\r\n  const newWords = newText.split(/(\\s+)/);\r\n  const oldSet = new Set(oldWords);\r\n  const newSet = new Set(newWords);\r\n\r\n  return (\r\n    <div className=\"border border-gray-300 rounded-xl overflow-hidden bg-white\">\r\n      <div className=\"grid grid-cols-2 divide-x divide-gray-300\">\r\n        {/* Old Version */}\r\n        <div className=\"p-4 bg-gradient-to-b from-red-50/50 to-white\">\r\n          <div className=\"flex items-center gap-2 mb-3\">\r\n            <div className=\"h-2 w-2 bg-red-500 rounded-full\"></div>\r\n            <div className=\"text-sm font-bold text-red-700\">OLD VERSION</div>\r\n          </div>\r\n          <div className=\"text-base leading-relaxed\">\r\n            <div className=\"line-through text-gray-600\">\r\n              {oldWords.map((w, i) => (\r\n                <span\r\n                  key={i}\r\n                  className={!newSet.has(w) ? \"bg-red-200/80 text-red-900 px-1 py-0.5 rounded mx-0.5\" : \"\"}\r\n                >\r\n                  {w}\r\n                </span>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* New Version */}\r\n        <div className=\"p-4 bg-gradient-to-b from-emerald-50/50 to-white\">\r\n          <div className=\"flex items-center gap-2 mb-3\">\r\n            <div className=\"h-2 w-2 bg-emerald-500 rounded-full\"></div>\r\n            <div className=\"text-sm font-bold text-emerald-700\">NEW VERSION</div>\r\n          </div>\r\n          <div className=\"text-base leading-relaxed\">\r\n            {newWords.map((w, i) => (\r\n              <span\r\n                key={i}\r\n                className={!oldSet.has(w) ? \"bg-emerald-200/80 text-emerald-900 px-1 py-0.5 rounded mx-0.5\" : \"\"}\r\n              >\r\n                {w}\r\n              </span>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction ExpandableText({ text, title, maxLength = 300, type = \"normal\" }: { \r\n  text: string | null | undefined; \r\n  title?: string;\r\n  maxLength?: number;\r\n  type?: \"normal\" | \"ai\";\r\n}) {\r\n  const raw = normalizeText(text);\r\n  const [expanded, setExpanded] = useState(false);\r\n  const isLong = raw.length > maxLength;\r\n  const shown = expanded ? raw : raw.slice(0, maxLength) + (isLong ? \"...\" : \"\");\r\n\r\n  const bgColor = type === \"ai\" ? \"bg-gradient-to-br from-blue-50/80 to-blue-100/50\" : \"bg-gray-50\";\r\n\r\n  return (\r\n    <div className={`rounded-xl p-4 ${bgColor} border ${type === \"ai\" ? \"border-blue-200\" : \"border-gray-200\"}`}>\r\n      {title && (\r\n        <div className=\"flex items-center gap-2 mb-3\">\r\n          <span className=\"text-base font-bold text-gray-900\">{title}</span>\r\n        </div>\r\n      )}\r\n      <div className=\"text-base text-gray-800 whitespace-pre-wrap leading-relaxed font-normal\">\r\n        {raw || <span className=\"text-gray-400 italic\">ไม่มีข้อมูล</span>}\r\n      </div>\r\n      {isLong && (\r\n        <button\r\n          type=\"button\"\r\n          onClick={() => setExpanded(!expanded)}\r\n          className=\"mt-3 px-3 py-1.5 text-sm font-medium text-blue-600 hover:text-blue-800 bg-white border border-blue-200 rounded-lg hover:bg-blue-50 transition-colors\"\r\n        >\r\n          {expanded ? \"ย่อข้อความ\" : \"อ่านต่อ...\"}\r\n        </button>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n/* ================= AI MODE SELECTOR ================= */\r\n\r\nfunction AIModeSelector({ mode, onChange }: { mode: AiMode; onChange: (mode: AiMode) => void }) {\r\n  const modes = [\r\n    { value: \"risk\", label: \"วิเคราะห์ความเสี่ยง\", icon: ExclamationTriangleIcon, color: \"from-red-500 to-rose-600\" },\r\n    { value: \"short\", label: \"ตอบแบบสั้น\", icon: BoltIcon, color: \"from-emerald-500 to-green-600\" },\r\n    { value: \"detailed\", label: \"ตอบแบบละเอียด\", icon: BeakerIcon, color: \"from-blue-500 to-cyan-600\" },\r\n    { value: \"legal\", label: \"เชิงกฎหมาย\", icon: ScaleIcon, color: \"from-purple-500 to-violet-600\" },\r\n  ] as const;\r\n\r\n  return (\r\n    <div className=\"grid grid-cols-2 md:grid-cols-4 gap-2\">\r\n      {modes.map((item) => {\r\n        const Icon = item.icon;\r\n        const isActive = mode === item.value;\r\n        \r\n        return (\r\n          <button\r\n            key={item.value}\r\n            onClick={() => onChange(item.value)}\r\n            className={`\r\n              flex flex-col items-center p-3 rounded-xl border transition-all duration-200\r\n              ${isActive \r\n                ? `bg-gradient-to-r ${item.color} text-white border-transparent shadow-md` \r\n                : \"bg-white text-gray-700 border-gray-300 hover:border-gray-400 hover:bg-gray-50\"\r\n              }\r\n            `}\r\n          >\r\n            <Icon className=\"h-6 w-6 mb-2\" />\r\n            <span className=\"text-xs font-semibold\">{item.label}</span>\r\n          </button>\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n}\r\n\r\n/* ================= AI CHAT COMPONENT ================= */\r\n\r\nfunction AIChat({ change }: { change: ChangeItem }) {\r\n  const [chatOpen, setChatOpen] = useState(false);\r\n  const [chatMode, setChatMode] = useState<AiMode>(\"risk\");\r\n  const [chatQuestion, setChatQuestion] = useState(\"\");\r\n  const [chatLoading, setChatLoading] = useState(false);\r\n  const [chatAnswer, setChatAnswer] = useState(\"\");\r\n  const [chatError, setChatError] = useState<string | null>(null);\r\n\r\n  const sendChat = async () => {\r\n    const question = normalizeText(chatQuestion);\r\n    const mode = chatMode;\r\n\r\n    if (!question) return;\r\n\r\n    setChatLoading(true);\r\n    setChatError(null);\r\n\r\n    try {\r\n      const res = await fetch(`${API_BASE}/changes/${change.id}/chat`, {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ question, mode }),\r\n      });\r\n\r\n      if (!res.ok) throw new Error(`Chat failed (${res.status})`);\r\n      const data = await res.json();\r\n\r\n      setChatAnswer(normalizeText(data?.answer) || \"\");\r\n    } catch (e: any) {\r\n      setChatError(e?.message || \"ส่งคำถามไม่สำเร็จ\");\r\n    } finally {\r\n      setChatLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      {/* AI Analysis Grid */}\r\n      <div className=\"grid md:grid-cols-2 gap-4\">\r\n        {/* AI Comment */}\r\n        <div className=\"rounded-xl overflow-hidden border border-blue-200 bg-gradient-to-br from-blue-50/80 to-white\">\r\n          <div className=\"bg-gradient-to-r from-blue-600 to-blue-700 px-4 py-3\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <InformationCircleIcon className=\"h-5 w-5 text-white\" />\r\n                <h3 className=\"text-base font-bold text-white\">ความคิดเห็นจาก AI</h3>\r\n              </div>\r\n              <CopyButton text={normalizeText(change.ai_comment)} size=\"sm\" variant=\"primary\" />\r\n            </div>\r\n          </div>\r\n          <div className=\"p-4\">\r\n            <ExpandableText text={change.ai_comment} type=\"ai\" />\r\n          </div>\r\n        </div>\r\n\r\n        {/* AI Suggestion */}\r\n        <div className=\"rounded-xl overflow-hidden border border-amber-200 bg-gradient-to-br from-amber-50/80 to-white\">\r\n          <div className=\"bg-gradient-to-r from-amber-600 to-amber-700 px-4 py-3\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <LightBulbIcon className=\"h-5 w-5 text-white\" />\r\n                <h3 className=\"text-base font-bold text-white\">คำแนะนำจาก AI</h3>\r\n              </div>\r\n              <CopyButton text={normalizeText(change.ai_suggestion)} size=\"sm\" variant=\"primary\" />\r\n            </div>\r\n          </div>\r\n          <div className=\"p-4\">\r\n            <ExpandableText text={change.ai_suggestion} type=\"ai\" />\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Risk Reason */}\r\n      {normalizeText(change.risk_reason) && (\r\n        <div className=\"rounded-xl border border-gray-200 bg-gradient-to-br from-gray-50/80 to-white p-4\">\r\n          <div className=\"flex items-center gap-2 mb-2\">\r\n            <ExclamationTriangleIcon className=\"h-5 w-5 text-gray-700\" />\r\n            <h3 className=\"text-base font-bold text-gray-900\">เหตุผลระดับความเสี่ยง</h3>\r\n          </div>\r\n          <div className=\"text-base text-gray-700 leading-relaxed\">{change.risk_reason}</div>\r\n        </div>\r\n      )}\r\n\r\n      {/* AI Chat Interface */}\r\n      <div className=\"rounded-xl border border-purple-200 overflow-hidden bg-gradient-to-br from-purple-50/30 to-white\">\r\n        <button\r\n          onClick={() => setChatOpen(!chatOpen)}\r\n          className=\"w-full px-4 py-3 bg-gradient-to-r from-purple-600 to-purple-700 flex items-center justify-between hover:from-purple-700 hover:to-purple-800 transition-all\"\r\n        >\r\n          <div className=\"flex items-center gap-2\">\r\n            <ChatBubbleLeftRightIcon className=\"h-5 w-5 text-white\" />\r\n            <span className=\"text-base font-bold text-white\">ถาม AI เพิ่มเติมเกี่ยวกับจุดนี้</span>\r\n          </div>\r\n          <span className=\"text-white font-bold\">{chatOpen ? \"▲\" : \"▼\"}</span>\r\n        </button>\r\n\r\n        {chatOpen && (\r\n          <div className=\"p-4\">\r\n            <div className=\"mb-4\">\r\n              <label className=\"block text-sm font-bold text-gray-700 mb-3\">เลือกโหมดการวิเคราะห์</label>\r\n              <AIModeSelector mode={chatMode} onChange={setChatMode} />\r\n            </div>\r\n\r\n            <div className=\"mb-4\">\r\n              <label className=\"block text-sm font-bold text-gray-700 mb-2\">คำถามของคุณ</label>\r\n              <textarea\r\n                value={chatQuestion}\r\n                onChange={(e) => setChatQuestion(e.target.value)}\r\n                placeholder=\"พิมพ์คำถามเกี่ยวกับการเปลี่ยนแปลงนี้...\"\r\n                rows={3}\r\n                className=\"w-full px-4 py-3 text-base border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none\"\r\n              />\r\n            </div>\r\n\r\n            {chatError && (\r\n              <div className=\"mb-4 p-3 bg-red-50 border border-red-200 rounded-xl\">\r\n                <p className=\"text-sm text-red-700 flex items-center gap-2\">\r\n                  <ExclamationTriangleIcon className=\"h-4 w-4\" />\r\n                  {chatError}\r\n                </p>\r\n              </div>\r\n            )}\r\n\r\n            <div className=\"flex gap-2\">\r\n              <button\r\n                onClick={sendChat}\r\n                disabled={chatLoading || !chatQuestion.trim()}\r\n                className=\"px-4 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl hover:from-blue-700 hover:to-blue-800 font-medium disabled:opacity-50 transition-all\"\r\n              >\r\n                {chatLoading ? (\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <ArrowPathIcon className=\"h-4 w-4 animate-spin\" />\r\n                    กำลังวิเคราะห์...\r\n                  </div>\r\n                ) : \"ส่งคำถาม\"}\r\n              </button>\r\n              <CopyButton text={chatAnswer} label=\"คัดลอกคำตอบ\" variant=\"primary\" />\r\n            </div>\r\n\r\n            {chatAnswer && (\r\n              <div className=\"mt-4 p-4 bg-gradient-to-br from-blue-50/50 to-white border border-blue-200 rounded-xl\">\r\n                <div className=\"flex items-center gap-2 mb-2\">\r\n                  <SparklesIcon className=\"h-5 w-5 text-blue-600\" />\r\n                  <h4 className=\"text-base font-bold text-gray-900\">คำตอบจาก AI</h4>\r\n                </div>\r\n                <div className=\"text-base text-gray-800 whitespace-pre-wrap leading-relaxed\">{chatAnswer}</div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n/* ================= REPORT GENERATOR ================= */\r\n\r\nfunction ReportGenerator({ detail, riskSummary }: { detail: ComparisonDetail; riskSummary: any }) {\r\n  const reportRef = useRef<HTMLDivElement>(null);\r\n  const [isGenerating, setIsGenerating] = useState(false);\r\n  const [showReportPreview, setShowReportPreview] = useState(false);\r\n\r\n  const handleGeneratePDF = async () => {\r\n    if (!reportRef.current) return;\r\n    \r\n    setIsGenerating(true);\r\n    try {\r\n      const canvas = await html2canvas(reportRef.current, {\r\n        scale: 2,\r\n        useCORS: true,\r\n        logging: false,\r\n        backgroundColor: '#ffffff',\r\n        windowWidth: 794, // A4 width in pixels at 96 DPI\r\n      });\r\n\r\n      const imgData = canvas.toDataURL('image/png');\r\n      const pdf = new jsPDF({\r\n        orientation: 'portrait',\r\n        unit: 'mm',\r\n        format: 'a4',\r\n      });\r\n\r\n      const imgWidth = 190;\r\n      const pageHeight = 297;\r\n      const imgHeight = (canvas.height * imgWidth) / canvas.width;\r\n      \r\n      let position = 0;\r\n      pdf.addImage(imgData, 'PNG', 10, position, imgWidth, imgHeight);\r\n      \r\n      // Add more pages if content is too long\r\n      let heightLeft = imgHeight;\r\n      position = 10;\r\n      \r\n      while (heightLeft >= pageHeight) {\r\n        position = position - pageHeight + 10;\r\n        pdf.addPage();\r\n        pdf.addImage(imgData, 'PNG', 10, position, imgWidth, imgHeight);\r\n        heightLeft -= pageHeight;\r\n      }\r\n\r\n      pdf.save(`รายงานสรุปผล_${detail.document_name}_${new Date().toISOString().split('T')[0]}.pdf`);\r\n    } catch (error) {\r\n      console.error(\"Error generating PDF:\", error);\r\n    } finally {\r\n      setIsGenerating(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {/* Report Actions */}\r\n      <div className=\"bg-white rounded-2xl border border-gray-200 p-4 mb-6\">\r\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-3\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <DocumentArrowDownIcon className=\"h-5 w-5 text-gray-700\" />\r\n            <h3 className=\"font-bold text-gray-900\">สร้างรายงานสรุปผล</h3>\r\n          </div>\r\n          <div className=\"flex flex-wrap gap-2\">\r\n            <button\r\n              onClick={() => setShowReportPreview(!showReportPreview)}\r\n              className=\"px-4 py-2 bg-white border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-50\"\r\n            >\r\n              {showReportPreview ? \"ซ่อนตัวอย่าง\" : \"แสดงตัวอย่างรายงาน\"}\r\n            </button>\r\n            <button\r\n              onClick={handleGeneratePDF}\r\n              disabled={isGenerating}\r\n              className=\"px-4 py-2 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg font-medium hover:from-blue-700 hover:to-blue-800 disabled:opacity-50 flex items-center gap-2\"\r\n            >\r\n              <DocumentArrowDownIcon className=\"h-4 w-4\" />\r\n              {isGenerating ? \"กำลังสร้าง PDF...\" : \"ดาวน์โหลดรายงาน PDF\"}\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Report Preview */}\r\n      {showReportPreview && (\r\n        <div className=\"mb-8\">\r\n          <div className=\"bg-white rounded-2xl border border-gray-200 shadow-lg p-4\">\r\n            <div className=\"flex items-center justify-between mb-4\">\r\n              <h3 className=\"text-lg font-bold text-gray-900\">ตัวอย่างรายงานสรุปผล</h3>\r\n              <div className=\"flex gap-2\">\r\n                <button\r\n                  onClick={() => window.print()}\r\n                  className=\"flex items-center gap-2 px-3 py-2 text-gray-700 hover:text-gray-900\"\r\n                >\r\n                  <PrinterIcon className=\"h-5 w-5\" />\r\n                  พิมพ์\r\n                </button>\r\n              </div>\r\n            </div>\r\n            \r\n            {/* Report Content - A4 Format */}\r\n            <div \r\n              ref={reportRef}\r\n              className=\"bg-white mx-auto border border-gray-300 shadow-inner overflow-hidden\"\r\n              style={{ \r\n                width: '210mm', \r\n                minHeight: '297mm',\r\n                padding: '25mm'\r\n              }}\r\n            >\r\n              {/* Report Header */}\r\n              <div className=\"text-center mb-8\">\r\n                <div className=\"flex items-center justify-center gap-3 mb-3\">\r\n                  <DocumentMagnifyingGlassIcon className=\"h-10 w-10 text-blue-600\" />\r\n                  <h1 className=\"text-2xl font-bold text-gray-900\">รายงานสรุปผลการเปรียบเทียบเอกสาร</h1>\r\n                </div>\r\n                <div className=\"text-sm text-gray-600\">เลขที่รายงาน: {detail.id}</div>\r\n              </div>\r\n\r\n              {/* Document Info */}\r\n              <div className=\"mb-8\">\r\n                <h2 className=\"text-xl font-bold text-gray-900 mb-4 border-b pb-2\">ข้อมูลเอกสาร</h2>\r\n                <div className=\"grid grid-cols-2 gap-4\">\r\n                  <div>\r\n                    <div className=\"text-sm text-gray-600 font-medium mb-1\">ชื่อเอกสาร</div>\r\n                    <div className=\"text-base font-semibold text-gray-800\">{detail.document_name}</div>\r\n                  </div>\r\n                  <div>\r\n                    <div className=\"text-sm text-gray-600 font-medium mb-1\">วันที่จัดทำ</div>\r\n                    <div className=\"text-base font-semibold text-gray-800\">{formatDateForReport(detail.created_at)}</div>\r\n                  </div>\r\n                  <div>\r\n                    <div className=\"text-sm text-gray-600 font-medium mb-1\">จากเวอร์ชัน</div>\r\n                    <div className=\"text-base font-semibold text-gray-800\">{detail.version_old_label}</div>\r\n                  </div>\r\n                  <div>\r\n                    <div className=\"text-sm text-gray-600 font-medium mb-1\">เป็นเวอร์ชัน</div>\r\n                    <div className=\"text-base font-semibold text-gray-800\">{detail.version_new_label}</div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Executive Summary */}\r\n              <div className=\"mb-8\">\r\n                <h2 className=\"text-xl font-bold text-gray-900 mb-4 border-b pb-2\">สรุปผลการวิเคราะห์</h2>\r\n                <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\r\n                  <p className=\"text-base text-gray-800 leading-relaxed\">{detail.summary_text}</p>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Risk Analysis */}\r\n              <div className=\"mb-8\">\r\n                <h2 className=\"text-xl font-bold text-gray-900 mb-4 border-b pb-2\">การวิเคราะห์ความเสี่ยง</h2>\r\n                <div className=\"grid grid-cols-4 gap-3 mb-4\">\r\n                  <div className=\"bg-red-50 border border-red-200 rounded-lg p-3 text-center\">\r\n                    <div className=\"text-2xl font-bold text-red-700\">{riskSummary.HIGH}</div>\r\n                    <div className=\"text-sm font-medium text-red-600\">HIGH</div>\r\n                  </div>\r\n                  <div className=\"bg-amber-50 border border-amber-200 rounded-lg p-3 text-center\">\r\n                    <div className=\"text-2xl font-bold text-amber-700\">{riskSummary.MEDIUM}</div>\r\n                    <div className=\"text-sm font-medium text-amber-600\">MEDIUM</div>\r\n                  </div>\r\n                  <div className=\"bg-emerald-50 border border-emerald-200 rounded-lg p-3 text-center\">\r\n                    <div className=\"text-2xl font-bold text-emerald-700\">{riskSummary.LOW}</div>\r\n                    <div className=\"text-sm font-medium text-emerald-600\">LOW</div>\r\n                  </div>\r\n                  <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-3 text-center\">\r\n                    <div className=\"text-2xl font-bold text-blue-700\">{riskSummary.TOTAL}</div>\r\n                    <div className=\"text-sm font-medium text-blue-600\">TOTAL</div>\r\n                  </div>\r\n                </div>\r\n                <div className=\"flex items-center gap-3\">\r\n                  <span className=\"text-base font-medium text-gray-700\">ระดับความเสี่ยงรวม:</span>\r\n                  {riskBadge(detail.overall_risk_level)}\r\n                </div>\r\n              </div>\r\n\r\n              {/* Footer */}\r\n              <div className=\"mt-12 pt-8 border-t border-gray-300\">\r\n                <div className=\"grid grid-cols-2 gap-8\">\r\n                  <div>\r\n                    <div className=\"text-sm font-medium text-gray-600 mb-2\">จัดทำโดย</div>\r\n                    <div className=\"text-base font-semibold text-gray-800\">ระบบวิเคราะห์เอกสารอัจฉริยะ</div>\r\n                  </div>\r\n                  <div className=\"text-right\">\r\n                    <div className=\"text-sm font-medium text-gray-600 mb-2\">วันที่สร้างรายงาน</div>\r\n                    <div className=\"text-base font-semibold text-gray-800\">{formatDateForReport(new Date().toISOString())}</div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </>\r\n  );\r\n}\r\n\r\n/* ================= MAIN PAGE ================= */\r\n\r\nexport default function CompareReportPage() {\r\n  const { id } = useParams<{ id: string }>();\r\n  const [detail, setDetail] = useState<ComparisonDetail | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [searchQuery, setSearchQuery] = useState(\"\");\r\n  const [riskFilter, setRiskFilter] = useState<\"ALL\" | RiskLevel>(\"ALL\");\r\n  const [typeFilter, setTypeFilter] = useState<\"ALL\" | ChangeType>(\"ALL\");\r\n  const [annotating, setAnnotating] = useState(false);\r\n  const [showFilters, setShowFilters] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (id) loadDetail();\r\n  }, [id]);\r\n\r\n  const loadDetail = async () => {\r\n    setLoading(true);\r\n    setError(null);\r\n    try {\r\n      const res = await fetch(`${API_BASE}/comparisons/${id}`, { cache: \"no-store\" });\r\n      if (!res.ok) throw new Error(`Failed to load (${res.status})`);\r\n      const data: ComparisonDetail = await res.json();\r\n      setDetail(data);\r\n    } catch (err: any) {\r\n      setError(err?.message || \"โหลดข้อมูลไม่สำเร็จ\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleAnnotate = async () => {\r\n    if (!id) return;\r\n    setAnnotating(true);\r\n    try {\r\n      const res = await fetch(`${API_BASE}/comparisons/${id}/annotate`, { method: \"POST\" });\r\n      if (!res.ok) throw new Error(`Annotation failed (${res.status})`);\r\n      await loadDetail();\r\n    } catch (err: any) {\r\n      console.error(\"Annotation error:\", err);\r\n    } finally {\r\n      setAnnotating(false);\r\n    }\r\n  };\r\n\r\n  const filteredChanges = useMemo(() => {\r\n    const changes = detail?.changes || [];\r\n    const query = searchQuery.trim();\r\n\r\n    return changes.filter(c => {\r\n      if (riskFilter !== \"ALL\") {\r\n        const lv = (c.risk_level || \"LOW\").toUpperCase();\r\n        if (lv !== riskFilter) return false;\r\n      }\r\n\r\n      if (typeFilter !== \"ALL\") {\r\n        if (c.change_type !== typeFilter) return false;\r\n      }\r\n\r\n      if (query.length > 0) {\r\n        const hay = [\r\n          c.section_label,\r\n          c.old_text,\r\n          c.new_text,\r\n          c.ai_comment,\r\n          c.ai_suggestion,\r\n          c.risk_reason,\r\n          c.change_type,\r\n          c.risk_level,\r\n        ]\r\n          .map(x => normalizeText(x as any))\r\n          .join(\" | \");\r\n\r\n        if (!contains(hay, query)) return false;\r\n      }\r\n\r\n      return true;\r\n    });\r\n  }, [detail?.changes, searchQuery, riskFilter, typeFilter]);\r\n\r\n  const riskSummary = useMemo(() => {\r\n    const changes = detail?.changes || [];\r\n    return {\r\n      HIGH: changes.filter(c => c.risk_level === \"HIGH\").length,\r\n      MEDIUM: changes.filter(c => c.risk_level === \"MEDIUM\").length,\r\n      LOW: changes.filter(c => c.risk_level === \"LOW\").length,\r\n      TOTAL: changes.length,\r\n    };\r\n  }, [detail?.changes]);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <ArrowPathIcon className=\"h-12 w-12 animate-spin text-blue-600 mx-auto\" />\r\n          <p className=\"mt-4 text-lg text-gray-700 font-medium\">กำลังโหลดรายงาน...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error || !detail) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center p-6\">\r\n        <div className=\"bg-white border border-red-200 rounded-xl p-8 max-w-md\">\r\n          <ExclamationTriangleIcon className=\"h-12 w-12 text-red-500 mx-auto\" />\r\n          <h2 className=\"text-xl font-bold text-gray-900 mt-4 text-center\">ไม่พบรายงาน</h2>\r\n          <p className=\"text-gray-600 mt-2 text-center\">{error || \"ไม่พบข้อมูลการเปรียบเทียบนี้\"}</p>\r\n          <button\r\n            onClick={loadDetail}\r\n            className=\"mt-6 w-full px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium\"\r\n          >\r\n            โหลดใหม่\r\n          </button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-b from-gray-50/50 to-gray-100 p-4 md:p-6\">\r\n      <div className=\"max-w-6xl mx-auto\">\r\n        {/* Header */}\r\n        <div className=\"mb-8\">\r\n          <div className=\"bg-white rounded-2xl border border-gray-200 shadow-sm p-6\">\r\n            <div className=\"flex flex-col lg:flex-row lg:items-start justify-between gap-6\">\r\n              <div className=\"flex-1\">\r\n                <h1 className=\"text-2xl lg:text-3xl font-bold text-gray-900 mb-3\">\r\n                  {detail.document_name}\r\n                </h1>\r\n                <div className=\"flex flex-wrap items-center gap-3 text-gray-700 mb-4\">\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <span className=\"px-3 py-1.5 bg-gradient-to-r from-blue-500 to-blue-600 text-white text-sm rounded-lg font-semibold\">\r\n                      {detail.version_old_label}\r\n                    </span>\r\n                    <span className=\"text-gray-500\">→</span>\r\n                    <span className=\"px-3 py-1.5 bg-gradient-to-r from-emerald-500 to-emerald-600 text-white text-sm rounded-lg font-semibold\">\r\n                      {detail.version_new_label}\r\n                    </span>\r\n                  </div>\r\n                  <div className=\"flex items-center gap-2 text-sm\">\r\n                    <span className=\"text-gray-500\">•</span>\r\n                    {formatDateTime(detail.created_at)}\r\n                  </div>\r\n                  <div className=\"flex items-center gap-2 text-sm\">\r\n                    <span className=\"text-gray-500\">•</span>\r\n                    <span>ID: {detail.id}</span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"flex flex-col items-start lg:items-end gap-4\">\r\n                <div className=\"text-right\">\r\n                  <div className=\"text-sm text-gray-600 font-medium mb-1\">ความเสี่ยงรวม</div>\r\n                  <div className={`text-2xl font-bold ${\r\n                    detail.overall_risk_level?.includes(\"HIGH\") ? \"text-red-600\" :\r\n                    detail.overall_risk_level?.includes(\"MEDIUM\") ? \"text-amber-600\" :\r\n                    \"text-emerald-600\"\r\n                  }`}>\r\n                    {detail.overall_risk_level || \"ไม่ระบุ\"}\r\n                  </div>\r\n                </div>\r\n                \r\n                <div className=\"flex gap-2\">\r\n                  <button\r\n                    onClick={handleAnnotate}\r\n                    disabled={annotating}\r\n                    className=\"flex items-center gap-2 px-4 py-2.5 bg-gradient-to-r from-purple-600 to-purple-700 text-white rounded-lg hover:from-purple-700 hover:to-purple-800 disabled:opacity-70 font-medium\"\r\n                  >\r\n                    {annotating ? (\r\n                      <ArrowPathIcon className=\"h-4 w-4 animate-spin\" />\r\n                    ) : (\r\n                      <SparklesIcon className=\"h-4 w-4\" />\r\n                    )}\r\n                    {annotating ? \"กำลังวิเคราะห์...\" : \"AI วิเคราะห์ใหม่\"}\r\n                  </button>\r\n                  \r\n                  <button\r\n                    onClick={() => setShowFilters(!showFilters)}\r\n                    className=\"flex items-center gap-2 px-4 py-2.5 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-medium\"\r\n                  >\r\n                    <AdjustmentsHorizontalIcon className=\"h-4 w-4\" />\r\n                    ฟิลเตอร์\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Risk Summary */}\r\n            <div className=\"mt-6 pt-6 border-t border-gray-200\">\r\n              <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3\">\r\n                <div className=\"bg-gradient-to-br from-red-50 to-white border border-red-200 rounded-xl p-4\">\r\n                  <div className=\"text-2xl font-bold text-red-700\">{riskSummary.HIGH}</div>\r\n                  <div className=\"text-sm font-medium text-red-600\">HIGH RISK</div>\r\n                </div>\r\n                <div className=\"bg-gradient-to-br from-amber-50 to-white border border-amber-200 rounded-xl p-4\">\r\n                  <div className=\"text-2xl font-bold text-amber-700\">{riskSummary.MEDIUM}</div>\r\n                  <div className=\"text-sm font-medium text-amber-600\">MEDIUM RISK</div>\r\n                </div>\r\n                <div className=\"bg-gradient-to-br from-emerald-50 to-white border border-emerald-200 rounded-xl p-4\">\r\n                  <div className=\"text-2xl font-bold text-emerald-700\">{riskSummary.LOW}</div>\r\n                  <div className=\"text-sm font-medium text-emerald-600\">LOW RISK</div>\r\n                </div>\r\n                <div className=\"bg-gradient-to-br from-blue-50 to-white border border-blue-200 rounded-xl p-4\">\r\n                  <div className=\"text-2xl font-bold text-blue-700\">{riskSummary.TOTAL}</div>\r\n                  <div className=\"text-sm font-medium text-blue-600\">TOTAL CHANGES</div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* AI Summary */}\r\n          {detail.summary_text && (\r\n            <div className=\"mt-6 bg-gradient-to-br from-blue-50/80 to-white rounded-2xl border border-blue-200 shadow-sm p-6\">\r\n              <div className=\"flex items-center gap-3 mb-4\">\r\n                <DocumentMagnifyingGlassIcon className=\"h-6 w-6 text-blue-600\" />\r\n                <h2 className=\"text-xl font-bold text-gray-900\">สรุปผลการวิเคราะห์</h2>\r\n              </div>\r\n              <div className=\"text-base text-gray-800 leading-relaxed bg-white/50 border border-blue-100 rounded-xl p-4\">\r\n                {detail.summary_text}\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Report Generator */}\r\n        <ReportGenerator detail={detail} riskSummary={riskSummary} />\r\n\r\n        {/* Filters */}\r\n        {showFilters && (\r\n          <div className=\"mb-6 bg-white rounded-2xl border border-gray-200 shadow-sm p-6\">\r\n            <div className=\"flex items-center justify-between mb-4\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <FunnelIcon className=\"h-5 w-5 text-gray-700\" />\r\n                <h3 className=\"font-bold text-gray-900\">ค้นหาและกรองข้อมูล</h3>\r\n              </div>\r\n              <button\r\n                onClick={() => setShowFilters(false)}\r\n                className=\"text-sm text-gray-600 hover:text-gray-900\"\r\n              >\r\n                ปิด\r\n              </button>\r\n            </div>\r\n            \r\n            <div className=\"space-y-4\">\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">ค้นหาคำ</label>\r\n                <div className=\"relative\">\r\n                  <MagnifyingGlassIcon className=\"h-5 w-5 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2\" />\r\n                  <input\r\n                    value={searchQuery}\r\n                    onChange={(e) => setSearchQuery(e.target.value)}\r\n                    placeholder=\"ค้นหาคำในรายการเปลี่ยนแปลง...\"\r\n                    className=\"w-full pl-10 pr-3 py-3 text-base border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"grid md:grid-cols-2 gap-4\">\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">กรองความเสี่ยง</label>\r\n                  <select\r\n                    value={riskFilter}\r\n                    onChange={(e) => setRiskFilter(e.target.value as any)}\r\n                    className=\"w-full px-3 py-3 text-base border border-gray-300 rounded-xl bg-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                  >\r\n                    <option value=\"ALL\">ความเสี่ยงทั้งหมด</option>\r\n                    <option value=\"HIGH\">HIGH</option>\r\n                    <option value=\"MEDIUM\">MEDIUM</option>\r\n                    <option value=\"LOW\">LOW</option>\r\n                  </select>\r\n                </div>\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">กรองประเภท</label>\r\n                  <select\r\n                    value={typeFilter}\r\n                    onChange={(e) => setTypeFilter(e.target.value as any)}\r\n                    className=\"w-full px-3 py-3 text-base border border-gray-300 rounded-xl bg-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                  >\r\n                    <option value=\"ALL\">ประเภททั้งหมด</option>\r\n                    <option value=\"ADDED\">ADDED</option>\r\n                    <option value=\"REMOVED\">REMOVED</option>\r\n                    <option value=\"MODIFIED\">MODIFIED</option>\r\n                  </select>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            \r\n            <div className=\"mt-4 text-sm text-gray-600\">\r\n              แสดง {filteredChanges.length} จาก {detail.changes.length} รายการ\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Changes List */}\r\n        <div className=\"space-y-6\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <h2 className=\"text-xl font-bold text-gray-900\">รายการเปลี่ยนแปลง</h2>\r\n            <div className=\"text-sm text-gray-600\">\r\n              {filteredChanges.length} รายการ\r\n            </div>\r\n          </div>\r\n\r\n          {filteredChanges.length === 0 ? (\r\n            <div className=\"bg-white rounded-2xl border border-gray-200 p-8 text-center\">\r\n              <p className=\"text-lg text-gray-500\">ไม่พบรายการเปลี่ยนแปลงตามเงื่อนไขที่เลือก</p>\r\n            </div>\r\n          ) : (\r\n            filteredChanges.map((change) => (\r\n              <div key={change.id} className=\"bg-white rounded-2xl border border-gray-200 shadow-sm overflow-hidden\">\r\n                {/* Header */}\r\n                <div className=\"bg-gradient-to-r from-gray-50 to-white border-b border-gray-200 p-5\">\r\n                  <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-3\">\r\n                    <div className=\"flex items-center gap-3\">\r\n                      {changeTypeBadge(change.change_type)}\r\n                      <h3 className=\"text-lg font-bold text-gray-900\">\r\n                        {change.section_label || \"ไม่มีหัวข้อ\"}\r\n                      </h3>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-3\">\r\n                      {riskBadge(change.risk_level)}\r\n                      <span className=\"text-sm text-gray-500\">ID: {change.id}</span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Content */}\r\n                <div className=\"p-5 space-y-6\">\r\n                  {/* Diff View with highlighted changes */}\r\n                  <div>\r\n                    <h4 className=\"text-base font-bold text-gray-800 mb-3\">การเปลี่ยนแปลงข้อความ</h4>\r\n                    <DiffView\r\n                      oldText={normalizeText(change.old_text)}\r\n                      newText={normalizeText(change.new_text)}\r\n                    />\r\n                  </div>\r\n\r\n                  {/* AI Analysis Section */}\r\n                  <div>\r\n                    <div className=\"flex items-center gap-3 mb-4\">\r\n                      <div className=\"h-8 w-1 bg-gradient-to-b from-purple-500 to-purple-600 rounded-full\"></div>\r\n                      <h4 className=\"text-lg font-bold text-gray-900\">การวิเคราะห์ด้วย AI</h4>\r\n                    </div>\r\n                    <AIChat change={change} />\r\n                  </div>\r\n\r\n                  {/* Quick Copy */}\r\n                  <div className=\"border-t border-gray-200 pt-4\">\r\n                    <CopyButton\r\n                      text={`[${change.section_label || \"-\"}]\\n` +\r\n                        `ประเภท: ${change.change_type} | ความเสี่ยง: ${change.risk_level}\\n\\n` +\r\n                        `OLD:\\n${change.old_text || \"-\"}\\n\\n` +\r\n                        `NEW:\\n${change.new_text || \"-\"}\\n\\n` +\r\n                        `AI COMMENT:\\n${change.ai_comment || \"-\"}\\n\\n` +\r\n                        `AI SUGGESTION:\\n${change.ai_suggestion || \"-\"}`\r\n                      }\r\n                      label=\"คัดลอกข้อมูลทั้งหมด\"\r\n                      variant=\"primary\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            ))\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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"}}]
}